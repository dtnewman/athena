<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <link rel="shortcut icon" href="./images/logo.ico">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Finch by dtnewman</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <a href="./index.html"><img src="./images/logo.png"  width="300" height="150"></a>
        <h2>A library for local search and stochastic optimization in Go.</h2>
        <a href="https://github.com/dtnewman/finch" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a name="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages"><span class="octicon octicon-link"></span></a>Simulated Annealing</h1>

<p>Simulated annealing is a very popular technique for global optimization. The method was adapted from the Metropolis-Hastings algorithm. The inspiration for the algorithm was the process of annealing in materials science, whereby materials and heated and cooled in a controlled way in order to reduce defects.</p>

<p>In simulated annealing, we start out with a an initial sate and then keep iterating, making small changes to the state each time. If the changes improve the objective function, then they are always accepted. If not, then we may <i>still</i> accept them with some probability. Typically, this process is repeated until a stopping condition is met.</p>

<p>The acceptance probability function <code>P(e,e',T)</code> (where <i>e</i> and <i>e'</i> are the old and new energies respectively and <i>T</i> is the temperature) is usually defined as 1 if <i>e'</i> < <i>e</i> and <i>exp(-(e'-e)/T)</i> otherwise.</p>

<p>An important aspect of simulated annealing is the changing temperature, <i>T</i>, which is used for the acceptance probability function described above. Typically, the temperature of the system is set to decrease gradually as the number of iterations increases. As a result, as the algorithm proceeds, it becomes progressively less likely that solutions with worse fitnesses will be accepted, which leads the algorithm to converge towards a local minima/maxima (which we hope is close to the global minima/maxima). The figure below shows a typical run for simulated annealing (on a minimization problem), with the iteration count on the X axis and the fitness on the Y axis:</p>

<img src="./images/sa.jpeg">

<p>As you can see, the algorithm makes bigger jumps towards the beginning when the temperature is high and it will tend to only allow small jumps in the later phases as the temperature decreases.</p>

<p> Below is pseudocode for simulated annealing:</p>

<pre><code>$ // Return a state that is an approximation of the global maximum
$ function <b>simulated annealing</b>(<i>initial_state</i>, <i>init_temperature</i>):
$ &nbsp;&nbsp;&nbsp;&nbsp;<i>best_state</i> &#8592 <i>initial_state</i>
$ &nbsp;&nbsp;&nbsp;&nbsp;<i>current_state</i> &#8592 <i>initial_state</i>
$ &nbsp;&nbsp;&nbsp;&nbsp;<i>current_fitness</i> &#8592 fitness(<i>current_state</i>)
$ &nbsp;&nbsp;&nbsp;&nbsp;<i>temperature</i> &#8592 <i>init_temperature</i>
$ &nbsp;&nbsp;&nbsp;&nbsp;<b>loop do</b>
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set <i>n</i> based on <i>temperature</i>
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>proposal_state</i> &#8592 make_n_changes(<i>current_state</i>,<i>n</i>)
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>proposal_fitness</i> &#8592 fitness(<i>proposal_state</i>)
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// If the new state is better than the current state, accept it
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>If</b> proposal_fitness > current_fitness:
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>current_state</i> &#8592 <i>proposal_state</i>
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>If</b> <i>proposal_fitness</i> > fitness(<i>best_state</i>):
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>best_state</i> &#8592 <i>proposal_state</i>
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// If the new state is not better than the current state, 
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// still accept with some probability
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>ElseIf</b> P(<i>current_fitness</i>, <i>proposal_fitness</i>, <i>temperature</i>) > random()):
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>current_state</i> &#8592 <i>proposal_state</i>
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>temperature</i> &#8592 Update(<i>temperature</i>)
$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check stopping condition. If met, return <i>best_state</i>
</code></pre>

<p>Since at any stage, the simulated annealing algorithm only makes changes to a state, rather than searching and storing all of its neighbors, it is generally a very memory efficient algorithm (it only needs to keep track of the current state, the proposed next state and the best state reached so far).</p> 

<p>The <i>finch</i> implementation of simulated annealing has the following signature:</p>
<pre><code>simulated_annealing(initial_solution []int, evaluate func([]int) float64, 
	make_change func([]int) []int, init_temp float64, thermostat float64, 
	itol int, reannealing int)
</code></pre>
<p>The function takes in the following parameters:</p>
<ul>
  <li><b>initial_solution</b> - An int[] array with an initial solution to seed the algorithm with</li>
  <li><b>evaluate</b> - A function that you must construct and pass in which takes a solution of type int[] as a parameter and returns a fitness score for the given solution of type float64</li>
  <li><b>make_change</b> - A function that takes in a solution of type int[] and makes one change to it, returning a new solution of type int[]</li>
  <li><b>init_temp</b> - The starting temperature for the algorithm</li>  
  <li><b>thermostat</b> - A number, generally between 0.85 and 0.99 that indicates how much the temperature should be adjusted when changes are made to the temperature</li>  
  <li><b>itol</b> - The maximum iterations to do before stopping</li>  
  <li><b>reannealing</b> - The number of accepted solutions before a temperature adjustement is made</li>  
</ul>
<p>The function returns two values:<p>
<ul>
  <li>The state at the local maximum (type []int)</li>
  <li>The fitness score at the local maximum (type float64)</li>
</ul>



<p><a href="./index.html">Return to home page</a></p>
        </section>

        <aside id="sidebar">
          <a href="./hill_climb.html" class="button">
            Hill climbing
          </a>
          <a href="./beam_search.html" class="button">
            Beam search
          </a>
          <a href="./tabu_search.html" class="button">
            Tabu search
          </a>
          <a href="./simulated_annealing.html" class="button">
            Simulated annealing
          </a>          
          <a href="./genetic_algorithms.html" class="button">
            Genetic algorithms
          </a>       
          <a href="./examples.html" class="button">
            Examples
          </a> 
          <p class="repo-owner"><a href="https://github.com/dtnewman/finch"></a>This website is maintained by <a href="https://github.com/dtnewman">dtnewman</a>.</p>

          <!--<p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>-->
        </aside>
      </div>
    </div>

  
  </body>
</html>
